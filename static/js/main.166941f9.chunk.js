(this["webpackJsonpcr-molkky"]=this["webpackJsonpcr-molkky"]||[]).push([[0],{17:function(e,t,n){},24:function(e,t,n){e.exports=n(36)},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"handleAdd",(function(){return g})),n.d(a,"handleDelete",(function(){return w})),n.d(a,"handleAddPoint",(function(){return O})),n.d(a,"handleNewGame",(function(){return j})),n.d(a,"handleRematch",(function(){return S})),n.d(a,"handleShuffle",(function(){return k}));var r=n(0),c=n.n(r),l=n(22),o=n.n(l),i=(n(29),n(7)),u=n(2);var s=function(){var e="v".concat("0.1.5");return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},"CR M\xf6lkky",c.a.createElement("div",{className:"float-right"},c.a.createElement(i.b,{to:"players",className:"btn btn-primary btn-sm mr-1"},"Start game"))),c.a.createElement("div",{className:"card-body"},c.a.createElement("p",{className:"card-text"},"Lorem impsum..."),c.a.createElement("p",{className:"card-text"},e))))},m=n(6),d=n(8),f=n.n(d),p=n(5),b=n(16),y=function(e){return 50!==e.currentPoints&&!e.disqualified},h="ADD_PLAYER",E="DELETE_PLAYER",v={players:[]},N=function(e,t){return e.players.map((function(e,n,a){if(e.name===t.payload.name){var r=e;return r.points.push(t.payload.points),r.currentPoints=function(e){return e.points.reduce((function(e,t){var n=e+t;return n>50?25:n}),0)}(r),r.disqualified=function(e){return!(e.points.length<3||e.handicap)&&e.points.slice(-3).every((function(e){return 0===e}))}(r),50===r.currentPoints&&0===r.finishedPos&&(r.finishedPos=a.filter((function(e){return e.finishedPos>0})).length+1),r}return e}))};function g(e,t){return{type:h,payload:{name:e,handicap:t,points:[],currentPoints:0,disqualified:!1,finishedPos:0}}}function w(e){return{type:E,payload:{name:e}}}function O(e,t){return{type:"ADD_POINT",payload:{name:e,points:t}}}function j(){return{type:"NEW_GAME"}}function S(){return{type:"REMATCH"}}function k(){return{type:"SHUFFLE"}}var P={reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(p.a)(Object(p.a)({},e),{},{players:[].concat(Object(b.a)(e.players),[t.payload])});case E:return Object(p.a)(Object(p.a)({},e),{},{players:e.players.filter((function(e){return e.name!==t.payload.name}))});case"ADD_POINT":return Object(p.a)(Object(p.a)({},e),{},{players:N(e,t)});case"NEW_GAME":return v;case"REMATCH":return Object(p.a)(Object(p.a)({},e),{},{players:e.players.map((function(e){var t=e;return t.points=[],t.currentPoints=0,t.misses=0,t.disqualified=!1,t.finishedPos=0,t}))});case"SHUFFLE":return Object(p.a)(Object(p.a)({},e),{},{players:e.players.map((function(e){return[Math.random(),e]})).sort((function(e,t){return e[0]-t[0]})).map((function(e){return e[1]}))});default:return e}},initialState:v,actions:a},C={players:P.initialState,version:"0.1.5"};function A(e,t){var n=e.players,a={players:P.reducer(n,t),version:"0.1.5"};return a}var D=Object(r.createContext)({});function R(e){var t=e.children,n=Object(r.useReducer)(A,C,(function(){var e=localStorage.getItem("data");if(!e)return C;var t=JSON.parse(e);return"0.1.5"===t.version?t:C})),a=Object(m.a)(n,2),l=a[0],o=a[1];return Object(r.useEffect)((function(){localStorage.setItem("data",JSON.stringify(l))}),[l]),c.a.createElement(D.Provider,{value:{state:l,dispatch:o}},t)}var x=P.actions,M=function(){var e=Object(r.useContext)(D),t=e.state,n=e.dispatch,a=t.players.players,c=function(e,t){var n=function(e,t){return function(){return t(e.apply(void 0,arguments))}};if("function"===typeof e)return n(e,t);if("object"!==typeof e||null===e)throw new Error("bindActions expected an object or a function, instead received ".concat(null===e?"null":typeof e,". "));var a={};return Object.entries(e).forEach((function(e){var r=Object(m.a)(e,2),c=r[0],l=r[1];"function"===typeof l&&(a[c]=n(l,t))})),a}({handleAdd:x.handleAdd,handleDelete:x.handleDelete,handleAddPoint:x.handleAddPoint,handleNewGame:x.handleNewGame,handleRematch:x.handleRematch,handleShuffle:x.handleShuffle},n),l=a.filter(y),o=function(e){return e.reduce((function(e,t){return t.points.length>e?t.points.length:e}),0)}(a),i=function(e,t){return e.filter(y).every((function(e){return e.points.length===t}))}(a,o),u=function(e,t){if(e<4)return[1,2,3,4];for(var n=[],a=t?e+1:e,r=a-3;r<=a;r+=1)n.push(r);return n}(o,i),s=function(e){return e.filter(y).reduce((function(e,t){if(!e.points)return t;var n=e.points.length,a=t.points.length;return n>a?t:n<a?e:t.currentPoints<e.currentPoints?t:e}),{})}(a),d=function(e,t){return e.sort((function(e,n){return t?!e.disqualified&&n.disqualified?-1:e.disqualified&&!n.disqualified?1:e.currentPoints>n.currentPoints?-1:e.currentPoints<n.currentPoints?1:0:0}))}(a,i);return Object(p.a)({players:a,playersLeft:l,playersTurn:s,playersByScore:d,currentRound:o,newRound:i,roundColumns:u},c)};var q=function(){var e=Object(r.useState)(""),t=Object(m.a)(e,2),n=t[0],a=t[1],l=Object(r.useState)(!1),o=Object(m.a)(l,2),i=o[0],s=o[1],d=Object(r.useState)("shuffle"),p=Object(m.a)(d,2),b=p[0],y=p[1],h=Object(u.g)(),E=M(),v=E.players,N=E.handleAdd,g=E.handleDelete,w=E.handleShuffle,O=f()("btn",{"btn-outline-secondary":!i,"btn-secondary":i}),j=0===n.length||0!==v.filter((function(e){return e.name===n})).length;return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},"Add players",c.a.createElement("div",{className:"float-right"},c.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",onClick:function(e){switch(e.preventDefault(),b){case"shuffle":w()}h.push("/game")}},"Start game"))),c.a.createElement("div",{className:"card-body"},c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),N(n,i),a(""),s(!1)}},c.a.createElement("div",{className:"input-group mb-3"},c.a.createElement("input",{type:"text",className:"form-control",id:"player","aria-label":"player",value:n,onChange:function(e){return a(e.target.value)}}),c.a.createElement("div",{className:"input-group-append",id:"button-addon3"},c.a.createElement("button",{className:O,type:"button",onClick:function(){return s(!i)}},"Handicap"),c.a.createElement("button",{className:"btn btn-outline-secondary",type:"submit",disabled:j},"+")))),c.a.createElement("ul",{className:"list-group mb-3"},v.map((function(e){return c.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center",key:e.name},c.a.createElement("span",null,e.name,c.a.createElement("button",{type:"button",className:"btn btn-link",onClick:function(){return g(e.name)}},"Delete")),e.handicap&&c.a.createElement("span",{className:"badge badge-primary badge-pill"},"Handicap"))}))),c.a.createElement("h6",{className:"card-title"},"Start order"),c.a.createElement("div",{className:"btn-group",role:"group","aria-label":"Start order"},c.a.createElement("button",{type:"button",className:"shuffle"===b?"btn btn-primary":"btn btn-outline-secondary",onClick:function(){return y("shuffle")}},"Shuffle"),c.a.createElement("button",{type:"button",className:"list"===b?"btn btn-primary":"btn btn-outline-secondary",onClick:function(){return y("list")}},"List")))))};function L(e){var t=e.children,n=e.href,a=e.onClick;return n?c.a.createElement(i.b,{to:n,className:"dropdown-item"},t):c.a.createElement("button",{className:"dropdown-item",type:"button",onClick:a},t)}L.defaultProps={href:"",children:"",onClick:function(){return null}};var I=L;var T=function(){return c.a.createElement("div",{className:"dropdown-divider"})};function G(e){var t=e.children,n=e.text,a=e.buttonStyle,l=e.menuStyle,o=Object(r.useState)(!1),i=Object(m.a)(o,2),u=i[0],s=i[1],d=Object(r.useRef)(),p=function(e){d.current.contains(e.target)||s(!1)};Object(r.useEffect)((function(){return document.addEventListener("mousedown",p),function(){document.removeEventListener("mousedown",p)}}),[]);var b=f()("btn btn-secondary dropdown-toggle",a),y=f()("dropdown-menu",l,{show:u});return c.a.createElement("div",{className:"dropdown",ref:d},c.a.createElement("button",{className:b,onClick:function(){return s((function(e){return!e}))},type:"button"},n),c.a.createElement("div",{className:y,"data-testid":"dropdown-menu"},t))}G.defaultProps={buttonStyle:"",menuStyle:""},G.Item=I,G.Divider=T;var H=G;n(17);var _=function(){var e=M().roundColumns,t={width:"".concat(12,"%")},n={width:"".concat(15,"%")};return c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",{scope:"col"},"Name"),e.map((function(e){return c.a.createElement("th",{scope:"col",style:t,key:e},e)})),c.a.createElement("th",{scope:"col",style:n},"Sum")))};var F=function(e){var t=e.player,n=M(),a=n.playersTurn,r=n.roundColumns,l=t.name,o=t.currentPoints,i=t.disqualified,u=t.handicap,s=t.points,m=50===o||i,d=f()({"table-primary":l===a.name,"table-disqualified":i,"table-warning":50===o});return c.a.createElement("tr",{key:l,className:d},c.a.createElement("th",{scope:"row"},l,u&&c.a.createElement("span",{className:"badge badge-warning"},"HCP")),r.map((function(e){var t=s[e-1];return c.a.createElement("td",{key:e},t>0&&t,0===t&&u&&"0",0===t&&!u&&c.a.createElement("span",{className:"badge badge-danger"},"X"),void 0===t&&m&&"-")})),c.a.createElement("td",null,o))};var J=function(){var e=M(),t=e.players,n=e.sortScore;return c.a.createElement("table",{className:"table"},c.a.createElement(_,null),c.a.createElement("tbody",null,t.sort(n).map((function(e){return c.a.createElement(F,{player:e,key:e.name})}))))};var W=function(){var e=Object(r.useState)(-1),t=Object(m.a)(e,2),n=t[0],a=t[1],l=M(),o=l.playersTurn,i=l.handleAddPoint,u=n>0?"OK (+".concat(n,")"):"Missed";return o.name?c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"points"},c.a.createElement("h5",{className:"card-title"},o.name,"'s turn"),c.a.createElement("div",{className:"mb-3"},Object(b.a)(Array(13)).map((function(e,t){var r=f()("btn btn-lg mr-1 mb-1",{"btn-primary":n===t,"btn-outline-primary":n!==t}),l="btnPoint".concat(t);return c.a.createElement("button",{type:"button",className:r,onClick:function(){return a(t)},key:t,"data-testid":l},t)}))),c.a.createElement("p",null,c.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return i(o.name,n),void a(-1)},disabled:n<0,"data-testid":"btnAdd"},u)))):null};var B=function(){var e=M(),t=e.players,n=e.handleNewGame,a=e.handleRematch;return 0===t.length?c.a.createElement(u.a,{to:"/"}):c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},"CR M\xf6lkky",c.a.createElement("div",{className:"float-right"},c.a.createElement(H,{text:"Menu",buttonStyle:"btn-sm",menuStyle:"dropdown-menu-right"},c.a.createElement(H.Item,{onClick:function(){window.confirm("Are you sure you want to start a new game?")&&n()}},"New game"),c.a.createElement(H.Item,{onClick:function(){window.confirm("Are you sure you want to restart the game?")&&a()}},"Restart game"),c.a.createElement(H.Divider,null),c.a.createElement(H.Item,{href:"/settings"},"Settings")))),c.a.createElement(J,null),c.a.createElement(W,null)))};var U=function(){return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},"CR M\xf6lkky",c.a.createElement("div",{className:"float-right"},c.a.createElement(i.b,{to:"/game",className:"btn btn-primary btn-sm"},"Game"))),c.a.createElement("div",{className:"card-body"},c.a.createElement("p",{className:"card-text"},"Settings..."))))};n(35);var Y=function(){return c.a.createElement(i.a,null,c.a.createElement(R,null,c.a.createElement(u.d,null,c.a.createElement(u.b,{exact:!0,path:"/",component:s}),c.a.createElement(u.b,{exact:!0,path:"/players",component:q}),c.a.createElement(u.b,{exact:!0,path:"/game",component:B}),c.a.createElement(u.b,{exact:!0,path:"/settings",component:U}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[24,1,2]]]);
//# sourceMappingURL=main.166941f9.chunk.js.map