(this["webpackJsonpcr-molkky"]=this["webpackJsonpcr-molkky"]||[]).push([[0],{17:function(e,t,n){},24:function(e,t,n){e.exports=n(36)},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"handleAdd",(function(){return E})),n.d(a,"handleDelete",(function(){return v})),n.d(a,"handleAddPoint",(function(){return N})),n.d(a,"handleNewGame",(function(){return g})),n.d(a,"handleRematch",(function(){return w})),n.d(a,"handleShuffle",(function(){return O}));var r=n(0),c=n.n(r),l=n(22),o=n.n(l),i=(n(29),n(7)),u=n(2),s=n(5),d=n(6),m=n(16),f=function(e){return 50!==e.currentPoints&&!e.disqualified},p="ADD_PLAYER",b="DELETE_PLAYER",y={players:[]},h=function(e,t){return e.players.map((function(e,n,a){if(e.name===t.payload.name){var r=e;return r.points.push(t.payload.points),r.currentPoints=function(e){return e.points.reduce((function(e,t){var n=e+t;return n>50?25:n}),0)}(r),r.disqualified=function(e){return!(e.points.length<3||e.handicap)&&e.points.slice(-3).every((function(e){return 0===e}))}(r),50===r.currentPoints&&0===r.finishedPos&&(r.finishedPos=a.filter((function(e){return e.finishedPos>0})).length+1),r}return e}))};function E(e,t){return{type:p,payload:{name:e,handicap:t,points:[],currentPoints:0,disqualified:!1,finishedPos:0}}}function v(e){return{type:b,payload:{name:e}}}function N(e,t){return{type:"ADD_POINT",payload:{name:e,points:t}}}function g(){return{type:"NEW_GAME"}}function w(){return{type:"REMATCH"}}function O(){return{type:"SHUFFLE"}}var j={reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object(s.a)(Object(s.a)({},e),{},{players:[].concat(Object(m.a)(e.players),[t.payload])});case b:return Object(s.a)(Object(s.a)({},e),{},{players:e.players.filter((function(e){return e.name!==t.payload.name}))});case"ADD_POINT":return Object(s.a)(Object(s.a)({},e),{},{players:h(e,t)});case"NEW_GAME":return y;case"REMATCH":return Object(s.a)(Object(s.a)({},e),{},{players:e.players.map((function(e){var t=e;return t.points=[],t.currentPoints=0,t.misses=0,t.disqualified=!1,t.finishedPos=0,t}))});case"SHUFFLE":return Object(s.a)(Object(s.a)({},e),{},{players:e.players.map((function(e){return[Math.random(),e]})).sort((function(e,t){return e[0]-t[0]})).map((function(e){return e[1]}))});default:return e}},initialState:y,actions:a},k={players:j.initialState,version:"0.1.6"};function S(e,t){var n=e.players,a={players:j.reducer(n,t),version:"0.1.6"};return a}var P=Object(r.createContext)({});function C(e){var t=e.children,n=Object(r.useReducer)(S,k,(function(){var e=localStorage.getItem("data");if(!e)return k;var t=JSON.parse(e);return"0.1.6"===t.version?t:k})),a=Object(d.a)(n,2),l=a[0],o=a[1];return Object(r.useEffect)((function(){localStorage.setItem("data",JSON.stringify(l))}),[l]),c.a.createElement(P.Provider,{value:{state:l,dispatch:o}},t)}var A=j.actions,D=function(){var e=Object(r.useContext)(P),t=e.state,n=e.dispatch,a=t.players.players,c=function(e,t){var n=function(e,t){return function(){return t(e.apply(void 0,arguments))}};if("function"===typeof e)return n(e,t);if("object"!==typeof e||null===e)throw new Error("bindActions expected an object or a function, instead received ".concat(null===e?"null":typeof e,". "));var a={};return Object.entries(e).forEach((function(e){var r=Object(d.a)(e,2),c=r[0],l=r[1];"function"===typeof l&&(a[c]=n(l,t))})),a}({handleAdd:A.handleAdd,handleDelete:A.handleDelete,handleAddPoint:A.handleAddPoint,handleNewGame:A.handleNewGame,handleRematch:A.handleRematch,handleShuffle:A.handleShuffle},n),l=a.filter(f),o=function(e){return e.reduce((function(e,t){return t.points.length>e?t.points.length:e}),0)}(a),i=function(e,t){return e.filter(f).every((function(e){return e.points.length===t}))}(a,o),u=function(e,t){if(e<4)return[1,2,3,4];for(var n=[],a=t?e+1:e,r=a-3;r<=a;r+=1)n.push(r);return n}(o,i),m=function(e){return e.filter(f).reduce((function(e,t){if(!e.points)return t;var n=e.points.length,a=t.points.length;return n>a?t:n<a?e:t.currentPoints<e.currentPoints?t:e}),{})}(a),p=function(e,t){return e.sort((function(e,n){return t?!e.disqualified&&n.disqualified?-1:e.disqualified&&!n.disqualified?1:e.currentPoints>n.currentPoints?-1:e.currentPoints<n.currentPoints?1:0:0}))}(a,i);return Object(s.a)({players:a,playersLeft:l,playersTurn:m,playersByScore:p,currentRound:o,newRound:i,roundColumns:u},c)};var R=function(){var e="v".concat("0.1.6"),t=D().handleNewGame;return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},"CR M\xf6lkky",c.a.createElement("div",{className:"float-right"},c.a.createElement(i.b,{to:"players",onClick:function(){return t()},className:"btn btn-primary btn-sm mr-1"},"Start game"))),c.a.createElement("div",{className:"card-body"},c.a.createElement("p",{className:"card-text"},e))))},x=n(8),M=n.n(x);var q=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],a=t[1],l=Object(r.useState)(!1),o=Object(d.a)(l,2),i=o[0],s=o[1],m=Object(r.useState)("shuffle"),f=Object(d.a)(m,2),p=f[0],b=f[1],y=Object(u.g)(),h=D(),E=h.players,v=h.handleAdd,N=h.handleDelete,g=h.handleShuffle,w=M()("btn",{"btn-outline-secondary":!i,"btn-secondary":i}),O=0===n.length||0!==E.filter((function(e){return e.name===n})).length;return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},"Add players",c.a.createElement("div",{className:"float-right"},c.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",onClick:function(e){switch(e.preventDefault(),p){case"shuffle":g()}y.push("/game")}},"Start game"))),c.a.createElement("div",{className:"card-body"},c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),v(n,i),a(""),s(!1)}},c.a.createElement("div",{className:"input-group mb-3"},c.a.createElement("input",{type:"text",className:"form-control",id:"player","aria-label":"player",value:n,onChange:function(e){return a(e.target.value)}}),c.a.createElement("div",{className:"input-group-append",id:"button-addon3"},c.a.createElement("button",{className:w,type:"button",onClick:function(){return s(!i)}},"Handicap"),c.a.createElement("button",{className:"btn btn-outline-secondary",type:"submit",disabled:O},"+")))),c.a.createElement("ul",{className:"list-group mb-3"},E.map((function(e){return c.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center",key:e.name},c.a.createElement("span",null,e.name,c.a.createElement("button",{type:"button",className:"btn btn-link",onClick:function(){return N(e.name)}},"Delete")),e.handicap&&c.a.createElement("span",{className:"badge badge-primary badge-pill"},"Handicap"))}))),c.a.createElement("h6",{className:"card-title"},"Start order"),c.a.createElement("div",{className:"btn-group",role:"group","aria-label":"Start order"},c.a.createElement("button",{type:"button",className:"shuffle"===p?"btn btn-primary":"btn btn-outline-secondary",onClick:function(){return b("shuffle")}},"Shuffle"),c.a.createElement("button",{type:"button",className:"list"===p?"btn btn-primary":"btn btn-outline-secondary",onClick:function(){return b("list")}},"List")))))};function I(e){var t=e.children,n=e.href,a=e.onClick;return n?c.a.createElement(i.b,{to:n,className:"dropdown-item"},t):c.a.createElement("button",{className:"dropdown-item",type:"button",onClick:a},t)}I.defaultProps={href:"",children:"",onClick:function(){return null}};var L=I;var G=function(){return c.a.createElement("div",{className:"dropdown-divider"})};function T(e){var t=e.children,n=e.text,a=e.buttonStyle,l=e.menuStyle,o=Object(r.useState)(!1),i=Object(d.a)(o,2),u=i[0],s=i[1],m=Object(r.useRef)(),f=function(e){m.current.contains(e.target)||s(!1)};Object(r.useEffect)((function(){return document.addEventListener("mousedown",f),function(){document.removeEventListener("mousedown",f)}}),[]);var p=M()("btn btn-secondary dropdown-toggle",a),b=M()("dropdown-menu",l,{show:u});return c.a.createElement("div",{className:"dropdown",ref:m},c.a.createElement("button",{className:p,onClick:function(){return s((function(e){return!e}))},type:"button"},n),c.a.createElement("div",{className:b,"data-testid":"dropdown-menu"},t))}T.defaultProps={buttonStyle:"",menuStyle:""},T.Item=L,T.Divider=G;var H=T;n(17);var _=function(){var e=D().roundColumns,t={width:"".concat(12,"%")},n={width:"".concat(15,"%")};return c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",{scope:"col"},"Name"),e.map((function(e){return c.a.createElement("th",{scope:"col",style:t,key:e},e)})),c.a.createElement("th",{scope:"col",style:n},"Sum")))};var F=function(e){var t=e.player,n=D(),a=n.playersTurn,r=n.roundColumns,l=t.name,o=t.currentPoints,i=t.disqualified,u=t.handicap,s=t.points,d=50===o||i,m=M()({"table-primary":l===a.name,"table-disqualified":i,"table-warning":50===o});return c.a.createElement("tr",{key:l,className:m},c.a.createElement("th",{scope:"row"},l,u&&c.a.createElement("span",{className:"badge badge-warning"},"HCP")),r.map((function(e){var t=s[e-1];return c.a.createElement("td",{key:e},t>0&&t,0===t&&u&&"0",0===t&&!u&&c.a.createElement("span",{className:"badge badge-danger"},"X"),void 0===t&&d&&"-")})),c.a.createElement("td",null,o))};var J=function(){var e=D(),t=e.players,n=e.sortScore;return c.a.createElement("table",{className:"table"},c.a.createElement(_,null),c.a.createElement("tbody",null,t.sort(n).map((function(e){return c.a.createElement(F,{player:e,key:e.name})}))))};var W=function(){var e=Object(r.useState)(-1),t=Object(d.a)(e,2),n=t[0],a=t[1],l=D(),o=l.playersTurn,i=l.handleAddPoint,u=n>0?"OK (+".concat(n,")"):"Missed";return o.name?c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"points"},c.a.createElement("h5",{className:"card-title"},o.name,"'s turn"),c.a.createElement("div",{className:"mb-3"},Object(m.a)(Array(13)).map((function(e,t){var r=M()("btn btn-lg mr-1 mb-1",{"btn-primary":n===t,"btn-outline-primary":n!==t}),l="btnPoint".concat(t);return c.a.createElement("button",{type:"button",className:r,onClick:function(){return a(t)},key:t,"data-testid":l},t)}))),c.a.createElement("p",null,c.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return i(o.name,n),void a(-1)},disabled:n<0,"data-testid":"btnAdd"},u)))):null};var B=function(){var e=D(),t=e.players,n=e.handleNewGame,a=e.handleRematch;return 0===t.length?c.a.createElement(u.a,{to:"/"}):c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},"CR M\xf6lkky",c.a.createElement("div",{className:"float-right"},c.a.createElement(H,{text:"Menu",buttonStyle:"btn-sm",menuStyle:"dropdown-menu-right"},c.a.createElement(H.Item,{onClick:function(){window.confirm("Are you sure you want to start a new game?")&&n()}},"New game"),c.a.createElement(H.Item,{onClick:function(){window.confirm("Are you sure you want to restart the game?")&&a()}},"Restart game"),c.a.createElement(H.Divider,null),c.a.createElement(H.Item,{href:"/settings"},"Settings")))),c.a.createElement(J,null),c.a.createElement(W,null)))};var U=function(){return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},"CR M\xf6lkky",c.a.createElement("div",{className:"float-right"},c.a.createElement(i.b,{to:"/game",className:"btn btn-primary btn-sm"},"Game"))),c.a.createElement("div",{className:"card-body"},c.a.createElement("p",{className:"card-text"},"Settings..."))))};n(35);var Y=function(){return c.a.createElement(i.a,null,c.a.createElement(C,null,c.a.createElement(u.d,null,c.a.createElement(u.b,{exact:!0,path:"/",component:R}),c.a.createElement(u.b,{exact:!0,path:"/players",component:q}),c.a.createElement(u.b,{exact:!0,path:"/game",component:B}),c.a.createElement(u.b,{exact:!0,path:"/settings",component:U}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[24,1,2]]]);
//# sourceMappingURL=main.96790474.chunk.js.map